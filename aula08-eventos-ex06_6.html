<!doctype html>
<html>
    <head>
        <title>Curso Javascript Completo 2018</title>
        <meta charset="utf-8">    

        <style>
            .taskDone {
                text-decoration: line-through;
                color: #555;
            }
        </style>

          
    </head>
    
    <body>
        <div class="container">
            <h1>Curso Javascript Completo 2018</h1>

            <div style="margin-bottom: 5px;">
                <input type="text" id="txtTask">
            </div>
            <div>                
                <button id="btnCadastrar">Cadastrar</button>
            </div>

            <ul>
                <li>Estudar JavaScript - DOM</li>
                <li>Estudar JavaScript - eventos</li>
                <li>Jogar vídeo-game</li>
            </ul>                     
        
        </div>      
        
        <script>

            // Seção 08: aula 59. Lista de Tarefas - parte 6
            /*
                - Delegação de eventos para resolver o excesso de listeners. Em vez de atribuir o escutador 
                de evento click para cada elemento <li>, foi atribuido um único escutador de evento click 
                para o elemento pai ou para o elemento imediatamente superior na árvore de hierarquia de objetos do DOM.
                - Uso da propriedade target.nodeName para identificar em qual elemento ocorreu o evento click;
                - Tratamento para não permitir a inclusão de itens em branco na lista. 
                
            */

            console.log('');
            console.log("############## Seção 08: Objetos, aula 59 #######################");

            (function(){
                'use strict'; 
                var $ul = document.querySelector("ul");
                var $lis = $ul.querySelectorAll("li");
                var $txtTask = document.querySelector("#txtTask");
                var $btnCadastrar = document.querySelector("#btnCadastrar");

                function addTask() {                   
                    //debugger;
                    var insertedText = $txtTask.value;

                    if(insertedText.trim().length > 0){                    
                        var li = document.createElement('li');
                        var text = document.createTextNode(insertedText);

                        li.appendChild(text);
                        $ul.appendChild(li);
                    }                    

                    $txtTask.value='';
                    $txtTask.focus();
                }

                $ul.addEventListener("click", function(e){
                    console.log("e.target.nodeName: ", e.target.nodeName);
                    if(e.target.nodeName === 'LI') {
                        toogleDone(e.target);
                    }
                });


                function toogleDone(li) {
                    //debugger;
                    li.classList.toggle("taskDone");                    
                }

                

                $btnCadastrar.addEventListener("click", addTask);   
                $txtTask.addEventListener("keyup", function(e){
                    //console.log("key code: ", e.keyCode);
                    if(e.keyCode === 13) {
                        //console.log("Pressionei a tecla Enter");
                        addTask();
                    }
                });             

            })();
            
        </script>
        
    </body>
</html>