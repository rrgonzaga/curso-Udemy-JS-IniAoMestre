<!doctype html>
<html>
    <head>
        <title>Javascript Completo</title>
        <meta charset="utf-8">
        
        <style type="text/css">

            body{
                font: 100%/2 sans-serif;
            }
        
            .nav{
                position: fixed;
                width: 150px;
                top: 25px;
                left: 10px;
                border: 1px solid #ccc;
            }

            .content{
                margin-left: 165px;
            }

            .nav ul{
                margin: 0;
                padding: 0;
                list-style: none;
            }
            .nav li{
                background: #ddd;
                
            }
            .nav li + li{
                margin-top: 2px;
            }
            .nav a{
                display: block;
                padding: 10px;
            }
            .nav a.actived{
                background: orange;
            }

	    </style>
        
    </head>
    <body>
        
        <nav class="nav">
            <ul>
                <li><a href="#s1">link 1</a></li>
                <li><a href="#s2">link 2</a></li>
                <li><a href="#s3">link 3</a></li>
            </ul>
        </nav>

        <main class="content">

            <h1>Javascript Completo</h1>

            <h2 id="s1">secao 1</h2>
            
            <p>1 - Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint fuga, deleniti repellat iure cum autem excepturi saepe totam quam, nam expedita aspernatur tenetur tempora, cupiditate. Sapiente cumque saepe maiores a.</p>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <h2 id="s2">secao 2</h2>

            <p>2 - Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint fuga, deleniti repellat iure cum autem excepturi saepe totam quam, nam expedita aspernatur tenetur tempora, cupiditate. Sapiente cumque saepe maiores a.</p>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            
            <h2 id="s3">secao 3</h2>
            
            <p>3 - Lorem ipsum dolor sit amet, consectetur adipisicing elit. Sint fuga, deleniti repellat iure cum autem excepturi saepe totam quam, nam expedita aspernatur tenetur tempora, cupiditate. Sapiente cumque saepe maiores a.</p>
            
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>
            <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Dolore autem aspernatur fugiat necessitatibus deleniti ea earum expedita exercitationem soluta unde suscipit saepe deserunt, illo est perferendis, at natus. Ducimus, voluptate!</p>

        </main>
        
    <script type="text/javascript">
        
        // Seção 39: Estilização - Aula 391 - Mostrar link ativo em uma single page (Continuação)            
        /* 
            - Em uma página long scrolling de navegação interna, identificar (destacar) no menu principal (fixo no topo da página) a seção atual enquanto o usuário scrolla a pagina.
        */

        (function(){

            var $menu = document.querySelector('.nav');
            var $links = $menu.querySelectorAll('li a');

            window.addEventListener("scroll", destacaMenu);

            destacaMenu();

            function destacaMenu() {

                var positions = [];
                for(var i=0; i < $links.length; i++){
                    positions[i] = pegaYPosicaoScroll($links[i]);
                }

                console.log("positions: ", positions);
                
                var linkAtivo = $menu.querySelector('.actived');
                if(linkAtivo) {
                    linkAtivo.classList.remove('actived');
                }

                var linkAtual = pegaUltimoLinkVisivel(positions);                
                linkAtual.classList.add('actived');
                
            }

            function pegaYPosicaoScroll(link) {
                    var alvo = document.querySelector(link.getAttribute('href'));
                    var positionYViewport = alvo.getBoundingClientRect().top;
                    return positionYViewport;
            }

            function pegaUltimoLinkVisivel(positions) {
                //Percorrer o array de trás para frente. 
                var qtd = positions.length;
                var metadeTela = innerHeight/2;
                while(qtd) {
                    qtd--;
                    if(positions[qtd] < metadeTela){
                        return $links[qtd];
                    }
                }
                return $links[0];
            }

        })();

    </script>    
        
    </body>
</html>